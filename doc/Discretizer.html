<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Discretizer
  
    &mdash; FSelector Documentation
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (D)</a> &raquo; 
    
    
    <span class="title">Discretizer</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Discretizer
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="ChiSquareCalculator.html" title="ChiSquareCalculator (module)">ChiSquareCalculator</a></span>, <span class='object_link'><a href="Entropy.html" title="Entropy (module)">Entropy</a></span></dd>
      
    
  
  
    <dt class="r2">Included in:</dt>
    <dd class="r2"><span class='object_link'><a href="FSelector/BaseContinuous.html" title="FSelector::BaseContinuous (class)">FSelector::BaseContinuous</a></span>, <span class='object_link'><a href="FSelector/CFS_c.html" title="FSelector::CFS_c (class)">FSelector::CFS_c</a></span>, <span class='object_link'><a href="FSelector/ReliefF_c.html" title="FSelector::ReliefF_c (class)">FSelector::ReliefF_c</a></span>, <span class='object_link'><a href="FSelector/Relief_c.html" title="FSelector::Relief_c (class)">FSelector::Relief_c</a></span></dd>
    
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/fselector/discretizer.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>discretize continous feature</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  



  <h2>Constant Summary</h2>
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="ChiSquareCalculator.html" title="ChiSquareCalculator (module)">ChiSquareCalculator</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ChiSquareCalculator.html#BIGX-constant" title="ChiSquareCalculator::BIGX (constant)">ChiSquareCalculator::BIGX</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#CHI_EPSILON-constant" title="ChiSquareCalculator::CHI_EPSILON (constant)">ChiSquareCalculator::CHI_EPSILON</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#CHI_MAX-constant" title="ChiSquareCalculator::CHI_MAX (constant)">ChiSquareCalculator::CHI_MAX</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#I_SQRT_PI-constant" title="ChiSquareCalculator::I_SQRT_PI (constant)">ChiSquareCalculator::I_SQRT_PI</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#LOG_SQRT_PI-constant" title="ChiSquareCalculator::LOG_SQRT_PI (constant)">ChiSquareCalculator::LOG_SQRT_PI</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#Z_MAX-constant" title="ChiSquareCalculator::Z_MAX (constant)">ChiSquareCalculator::Z_MAX</a></span></p>





  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#discretize_by_ChiMerge%21-instance_method" title="#discretize_by_ChiMerge! (instance method)">- <strong>discretize_by_ChiMerge!</strong>(alpha = 0.10) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>discretize by ChiMerge algorithm.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#discretize_by_equal_frequency%21-instance_method" title="#discretize_by_equal_frequency! (instance method)">- <strong>discretize_by_equal_frequency!</strong>(n_interval) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>discretize by equal-frequency intervals.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#discretize_by_equal_width%21-instance_method" title="#discretize_by_equal_width! (instance method)">- <strong>discretize_by_equal_width!</strong>(n_interval) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>discretize by equal-width intervals.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#discretize_by_MID%21-instance_method" title="#discretize_by_MID! (instance method)">- <strong>discretize_by_MID!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>discretize by Multi-Interval Discretization (MID) algorithm.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ChiSquareCalculator.html" title="ChiSquareCalculator (module)">ChiSquareCalculator</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ChiSquareCalculator.html#critchi-instance_method" title="ChiSquareCalculator#critchi (method)">#critchi</a></span>, <span class='object_link'><a href="ChiSquareCalculator.html#pochisq-instance_method" title="ChiSquareCalculator#pochisq (method)">#pochisq</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Entropy.html" title="Entropy (module)">Entropy</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Entropy.html#get_conditional_entropy-instance_method" title="Entropy#get_conditional_entropy (method)">#get_conditional_entropy</a></span>, <span class='object_link'><a href="Entropy.html#get_joint_entropy-instance_method" title="Entropy#get_joint_entropy (method)">#get_joint_entropy</a></span>, <span class='object_link'><a href="Entropy.html#get_marginal_entropy-instance_method" title="Entropy#get_marginal_entropy (method)">#get_marginal_entropy</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="discretize_by_ChiMerge!-instance_method">
  
    - <strong>discretize_by_ChiMerge!</strong>(alpha = 0.10) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong> 
    <div class='inline'><p>data structure will be altered</p>
</div>
  </div>

<p>discretize by ChiMerge algorithm</p>

<p>chi-squared values and associated p values are calculated via the
ChiSquareCalculator module</p>

<p>ref: <a href="http://sci2s.ugr.es/keel/pdf/algorithm/congreso/1992-Kerber-ChimErge-AAAI92.pdf">ChiMerge: Discretization of Numberic Attributes</a>
and <a href="http://en.wikipedia.org/wiki/Chi-squared_distribution">Wikipedia</a></p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>alpha</span>
      
      
        <span class='type'>(<tt>Float</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0.10</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>confidence level</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fselector/discretizer.rb', line 73</span>

<span class='kw'>def</span> <span class='id identifier rubyid_discretize_by_ChiMerge!'>discretize_by_ChiMerge!</span><span class='lparen'>(</span><span class='id identifier rubyid_alpha'>alpha</span><span class='op'>=</span><span class='float'>0.10</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_df'>df</span> <span class='op'>=</span> <span class='id identifier rubyid_get_classes'>get_classes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='op'>-</span><span class='int'>1</span>
  <span class='id identifier rubyid_chisq'>chisq</span> <span class='op'>=</span> <span class='id identifier rubyid_pval2chisq'>pval2chisq</span><span class='lparen'>(</span><span class='id identifier rubyid_alpha'>alpha</span><span class='comma'>,</span> <span class='id identifier rubyid_df'>df</span><span class='rparen'>)</span>
  
  <span class='comment'># for intialization
</span>  <span class='id identifier rubyid_hzero'>hzero</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_each_class'>each_class</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
    <span class='id identifier rubyid_hzero'>hzero</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='float'>0.0</span>
  <span class='kw'>end</span>
  
  <span class='comment'># determine the final boundaries for each feature
</span>  <span class='id identifier rubyid_f2bs'>f2bs</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_each_feature'>each_feature</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='comment'>#f = :&quot;sepal-length&quot;
</span>    <span class='comment'># 1a. initialize boundaries
</span>    <span class='id identifier rubyid_bs'>bs</span><span class='comma'>,</span> <span class='id identifier rubyid_cs'>cs</span><span class='comma'>,</span> <span class='id identifier rubyid_qs'>qs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_fvs'>fvs</span> <span class='op'>=</span> <span class='id identifier rubyid_get_feature_values'>get_feature_values</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
    <span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
      <span class='id identifier rubyid_bs'>bs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_v'>v</span>
      <span class='id identifier rubyid_cs'>cs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_hzero'>hzero</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='kw'>end</span>
    
    <span class='comment'># 1b. initialize counts for each interval
</span>    <span class='id identifier rubyid_each_sample'>each_sample</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span> <span class='id identifier rubyid_f'>f</span>
      <span class='id identifier rubyid_bs'>bs</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_s'>s</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_b'>b</span>
          <span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='float'>1.0</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    
    <span class='comment'># 1c. initialize chi-squared values between two adjacent intervals
</span>    <span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
        <span class='id identifier rubyid_qs'>qs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_chisq_calc'>chisq_calc</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='comma'>,</span> <span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    
    <span class='comment'># 2. iteratively merge intervals
</span>    <span class='kw'>until</span> <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>or</span> <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_chisq'>chisq</span>
      <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_q'>q</span> <span class='op'>!=</span> <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span>
        
        <span class='comment'># update cs for merged two intervals
</span>        <span class='id identifier rubyid_cm'>cm</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
        <span class='id identifier rubyid_each_class'>each_class</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
          <span class='id identifier rubyid_cm'>cm</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='op'>+</span><span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
        
        <span class='comment'># update qs if necessary
</span>        <span class='comment'># before merged intervals
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span><span class='op'>-</span><span class='int'>1</span> <span class='op'>&gt;=</span> <span class='int'>0</span>
          <span class='id identifier rubyid_qs'>qs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_chisq_calc'>chisq_calc</span><span class='lparen'>(</span><span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_cm'>cm</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='comment'># after merged intervals
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
          <span class='id identifier rubyid_qs'>qs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_chisq_calc'>chisq_calc</span><span class='lparen'>(</span><span class='id identifier rubyid_cm'>cm</span><span class='comma'>,</span> <span class='id identifier rubyid_cs'>cs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>2</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        
        <span class='comment'># merge up
</span>        <span class='id identifier rubyid_bs'>bs</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span><span class='semicolon'>;</span><span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span><span class='semicolon'>;</span><span class='id identifier rubyid_cs'>cs</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span> <span class='id identifier rubyid_cm'>cm</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_qs'>qs</span><span class='period'>.</span><span class='id identifier rubyid_delete_at'>delete_at</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span>
        
        <span class='comment'># note bs.size == cs.size+1 == bs.size+2
</span>        <span class='comment'>#cs.each_with_index do |c, i|
</span>        <span class='comment'>#  puts &quot;#{bs[i]} | #{c.values.join(' ')} | #{qs[i]}&quot;
</span>        <span class='comment'>#end
</span>        <span class='comment'>#puts
</span>        
        <span class='comment'># break out
</span>        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    
    <span class='comment'># 3. record the final boundaries
</span>    <span class='id identifier rubyid_f2bs'>f2bs</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_bs'>bs</span>
  <span class='kw'>end</span>
  
  <span class='comment'># discretize according to each feature's boundaries
</span>  <span class='id identifier rubyid_discretize_at_cutpoints!'>discretize_at_cutpoints!</span><span class='lparen'>(</span><span class='id identifier rubyid_f2bs'>f2bs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="discretize_by_equal_frequency!-instance_method">
  
    - <strong>discretize_by_equal_frequency!</strong>(n_interval) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong> 
    <div class='inline'><p>data structure will be altered</p>
</div>
  </div>

<p>discretize by equal-frequency intervals</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>n_interval</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>desired number of intervals</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fselector/discretizer.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_discretize_by_equal_frequency!'>discretize_by_equal_frequency!</span><span class='lparen'>(</span><span class='id identifier rubyid_n_interval'>n_interval</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_n_interval'>n_interval</span> <span class='op'>=</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_n_interval'>n_interval</span> <span class='op'>&lt;</span> <span class='int'>1</span> <span class='comment'># at least one interval
</span>  
  <span class='comment'># first determine the boundaries
</span>  <span class='id identifier rubyid_f2bs'>f2bs</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_each_feature'>each_feature</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_fvs'>fvs</span> <span class='op'>=</span> <span class='id identifier rubyid_get_feature_values'>get_feature_values</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
    <span class='comment'># number of samples in each interval
</span>    <span class='id identifier rubyid_ns'>ns</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='op'>/</span><span class='id identifier rubyid_n_interval'>n_interval</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
    <span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span><span class='op'>%</span><span class='id identifier rubyid_ns'>ns</span> <span class='op'>==</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span><span class='op'>&lt;</span><span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
        <span class='id identifier rubyid_f2bs'>f2bs</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='op'>+</span><span class='id identifier rubyid_fvs'>fvs</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>/</span><span class='float'>2.0</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># then discretize based on cut points
</span>  <span class='id identifier rubyid_discretize_at_cutpoints!'>discretize_at_cutpoints!</span><span class='lparen'>(</span><span class='id identifier rubyid_f2bs'>f2bs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="discretize_by_equal_width!-instance_method">
  
    - <strong>discretize_by_equal_width!</strong>(n_interval) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong> 
    <div class='inline'><p>data structure will be altered</p>
</div>
  </div>

<p>discretize by equal-width intervals</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>n_interval</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>desired number of intervals</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fselector/discretizer.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_discretize_by_equal_width!'>discretize_by_equal_width!</span><span class='lparen'>(</span><span class='id identifier rubyid_n_interval'>n_interval</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_n_interval'>n_interval</span> <span class='op'>=</span> <span class='int'>1</span> <span class='kw'>if</span> <span class='id identifier rubyid_n_interval'>n_interval</span> <span class='op'>&lt;</span> <span class='int'>1</span> <span class='comment'># at least one interval
</span>  
  <span class='comment'># first determine the boundary of each feature
</span>  <span class='id identifier rubyid_f2bs'>f2bs</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_h'>h</span><span class='comma'>,</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_h'>h</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_each_feature'>each_feature</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_fvs'>fvs</span> <span class='op'>=</span> <span class='id identifier rubyid_get_feature_values'>get_feature_values</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fmin'>fmin</span><span class='comma'>,</span> <span class='id identifier rubyid_fmax'>fmax</span> <span class='op'>=</span> <span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='comma'>,</span> <span class='id identifier rubyid_fvs'>fvs</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
    <span class='id identifier rubyid_delta'>delta</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_fmax'>fmax</span><span class='op'>-</span><span class='id identifier rubyid_fmin'>fmin</span><span class='rparen'>)</span><span class='op'>/</span><span class='id identifier rubyid_n_interval'>n_interval</span>
    
    <span class='lparen'>(</span><span class='id identifier rubyid_n_interval'>n_interval</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='id identifier rubyid_f2bs'>f2bs</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_fmin'>fmin</span><span class='op'>+</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span><span class='op'>*</span><span class='id identifier rubyid_delta'>delta</span>
     <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># then discretize based on cut points
</span>  <span class='id identifier rubyid_discretize_at_cutpoints!'>discretize_at_cutpoints!</span><span class='lparen'>(</span><span class='id identifier rubyid_f2bs'>f2bs</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="discretize_by_MID!-instance_method">
  
    - <strong>discretize_by_MID!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong> 
    <div class='inline'><p>no missing feature values allowed and data structure will be altered</p>
</div>
  </div>

<p>discretize by Multi-Interval Discretization (MID) algorithm</p>

<p>ref: <a href="http://www.ijcai.org/Past%20Proceedings/IJCAI-93-VOL2/PDF/022.pdf">Multi-Interval Discretization of Continuous-Valued Attributes for Classification Learning</a></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/fselector/discretizer.rb', line 166</span>

<span class='kw'>def</span> <span class='id identifier rubyid_discretize_by_MID!'>discretize_by_MID!</span>
  <span class='comment'># determine the final boundaries
</span>  <span class='id identifier rubyid_f2cp'>f2cp</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='comment'># cut points for each feature
</span>  <span class='id identifier rubyid_each_feature'>each_feature</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_cv'>cv</span> <span class='op'>=</span> <span class='id identifier rubyid_get_class_labels'>get_class_labels</span>
    <span class='comment'># we assume no missing feature values 
</span>    <span class='id identifier rubyid_fv'>fv</span> <span class='op'>=</span> <span class='id identifier rubyid_get_feature_values'>get_feature_values</span><span class='lparen'>(</span><span class='id identifier rubyid_f'>f</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_n'>n</span> <span class='op'>=</span> <span class='id identifier rubyid_cv'>cv</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='comment'># sort cv and fv according ascending order of fv
</span>    <span class='id identifier rubyid_sis'>sis</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>0</span><span class='op'>...</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='comma'>,</span><span class='id identifier rubyid_j'>j</span><span class='op'>|</span> <span class='id identifier rubyid_fv'>fv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_fv'>fv</span><span class='lbracket'>[</span><span class='id identifier rubyid_j'>j</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_cv'>cv</span> <span class='op'>=</span> <span class='id identifier rubyid_cv'>cv</span><span class='period'>.</span><span class='id identifier rubyid_values_at'>values_at</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_sis'>sis</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fv'>fv</span> <span class='op'>=</span> <span class='id identifier rubyid_fv'>fv</span><span class='period'>.</span><span class='id identifier rubyid_values_at'>values_at</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_sis'>sis</span><span class='rparen'>)</span>
    
    <span class='comment'># get initial boundaries
</span>    <span class='id identifier rubyid_bs'>bs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_fv'>fv</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_v'>v</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
      <span class='comment'># cut point (Ta) for feature A must always be a value between
</span>      <span class='comment'># two examples of different classes in the sequence of sorted examples
</span>      <span class='comment'># see orginal reference
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_i'>i</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_n'>n</span><span class='op'>-</span><span class='int'>1</span> <span class='kw'>and</span> <span class='id identifier rubyid_cv'>cv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_cv'>cv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_bs'>bs</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='op'>+</span><span class='id identifier rubyid_fv'>fv</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='op'>+</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='op'>/</span><span class='float'>2.0</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_bs'>bs</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span> <span class='comment'># remove duplicates
</span>    
    <span class='comment'># main algorithm, iteratively determine cut point
</span>    <span class='id identifier rubyid_cp'>cp</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_partition'>partition</span><span class='lparen'>(</span><span class='id identifier rubyid_cv'>cv</span><span class='comma'>,</span> <span class='id identifier rubyid_fv'>fv</span><span class='comma'>,</span> <span class='id identifier rubyid_bs'>bs</span><span class='comma'>,</span> <span class='id identifier rubyid_cp'>cp</span><span class='rparen'>)</span>
    
    <span class='comment'># add the rightmost boundary for convenience
</span>    <span class='id identifier rubyid_cp'>cp</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_fv'>fv</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='op'>+</span><span class='float'>1.0</span>
    <span class='comment'># record cut points for feature (f)
</span>    <span class='id identifier rubyid_f2cp'>f2cp</span><span class='lbracket'>[</span><span class='id identifier rubyid_f'>f</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cp'>cp</span>      
  <span class='kw'>end</span>
  
  <span class='comment'># discretize based on cut points
</span>  <span class='id identifier rubyid_discretize_at_cutpoints!'>discretize_at_cutpoints!</span><span class='lparen'>(</span><span class='id identifier rubyid_f2cp'>f2cp</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Apr 10 18:03:01 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.5 (ruby-1.9.3).
</div>

  </body>
</html>